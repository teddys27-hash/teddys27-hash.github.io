<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teddys.dev    
    </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #ffffff;
        }

        .header {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 15px 20px;
            gap: 15px;
        }

        .header a {
            color: #1f2937;
            text-decoration: none;
            font-size: 13px;
        }

        .header a:hover {
            text-decoration: underline;
        }

        .settings-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1f2937;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 200px);
            padding: 20px;
        }

        .logo {
            margin-bottom: 30px;
            font-size: 92px;
            font-weight: 400;
            color: #4285f4;
            text-align: center;
            letter-spacing: -3px;
        }

        .logo .g { color: #4285f4; }
        .logo .o { color: #ea4335; }
        .logo .o2 { color: #fbbc04; }
        .logo .g2 { color: #34a853; }
        .logo .l { color: #ea4335; }
        .logo .e { color: #4285f4; }

        .search-container {
            width: 100%;
            max-width: 584px;
            margin-bottom: 30px;
        }

        .search-box {
            display: flex;
            align-items: center;
            border: 1px solid #dadce0;
            border-radius: 24px;
            padding: 10px 16px;
            background-color: #fff;
            box-shadow: 0 2px 5px 1px rgba(64,60,57,.16);
            transition: all 0.2s ease;
        }

        .search-box:hover {
            box-shadow: 0 2px 8px 1px rgba(64,60,57,.24);
        }

        .search-box:focus-within {
            box-shadow: 0 2px 8px 1px rgba(64,60,57,.24);
            border-color: #dadce0;
        }

        .search-icon {
            color: #9aa0a6;
            margin-right: 12px;
            font-size: 16px;
            user-select: none;
        }

        .search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 16px;
            font-family: inherit;
        }

        .search-input::placeholder {
            color: #9aa0a6;
        }

        .clear-btn {
            background: none;
            border: none;
            color: #9aa0a6;
            cursor: pointer;
            font-size: 20px;
            padding: 0 8px;
            display: none;
        }

        .search-input:not(:placeholder-shown) ~ .clear-btn {
            display: block;
        }

        .buttons-container {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background-color: #f8f9fa;
            border: 1px solid #f8f9fa;
            border-radius: 4px;
            color: #3c4043;
            font-size: 14px;
            padding: 10px 24px;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.1s ease;
        }

        button:hover {
            box-shadow: 0 1px 1px rgba(0,0,0,.1);
            background-color: #f8f9fa;
            border: 1px solid #dadce0;
            color: #202124;
        }

        button:active {
            border: 1px solid #4285f4;
        }

        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: #f2f2f2;
            border-top: 1px solid #dadce0;
            padding: 15px 20px;
            font-size: 14px;
            color: #70757a;
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-content a {
            color: #70757a;
            text-decoration: none;
        }

        .footer-content a:hover {
            color: #4285f4;
            text-decoration: underline;
        }

        .snake-icon {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .snake-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .snake-icon:active {
            transform: scale(0.95);
        }

        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }

        .game-modal.show {
            display: flex;
        }

        .game-modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-game {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 32px;
            cursor: pointer;
            color: #999;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .close-game:hover {
            color: #333;
        }

        .game-menu {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 30px;
            text-align: center;
        }

        .game-menu.show {
            display: flex;
        }

        .game-menu h1 {
            color: #667eea;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 250px;
        }

        .menu-btn {
            padding: 15px 40px;
            font-size: 1.1em;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .menu-btn:hover {
            background-color: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .difficulty-menu {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .difficulty-menu.show {
            display: flex;
        }

        .difficulty-menu h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .difficulty-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 350px;
        }

        .difficulty-option {
            padding: 12px 20px;
            font-size: 1em;
            background-color: #f0f0f0;
            color: #333;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .difficulty-option:hover {
            background-color: #e0e0e0;
            border-color: #667eea;
        }

        .difficulty-option.selected {
            background-color: #667eea;
            color: white;
            border-color: #667eea;
        }

        .back-btn {
            margin-top: 20px;
            padding: 10px 25px;
            font-size: 0.95em;
            background-color: #ddd;
            color: #333;
        }

        .back-btn:hover {
            background-color: #ccc;
            box-shadow: none;
            transform: none;
        }

        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
            width: 200px;
            margin-left: auto;
            margin-right: auto;
        }

        .mobile-controls.show {
            display: grid;
        }

        .control-btn {
            padding: 15px;
            font-size: 24px;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .control-btn:active {
            background-color: #764ba2;
            transform: scale(0.95);
        }

        .control-btn.up { grid-column: 2; }
        .control-btn.left { grid-column: 1; grid-row: 2; }
        .control-btn.down { grid-column: 2; grid-row: 2; }
        .control-btn.right { grid-column: 3; grid-row: 2; }

        .difficulty-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
            flex-direction: column;
            align-items: center;
        }

        .difficulty-btn {
            padding: 10px 20px;
            font-size: 0.95em;
            background-color: #f0f0f0;
            color: #333;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .difficulty-btn:hover {
            background-color: #e0e0e0;
        }

        .difficulty-btn.active {
            background-color: #667eea;
            color: white;
            border-color: #667eea;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            text-align: center;
        }

        .game-container h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .info {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 1.1em;
            margin: 20px 0;
        }

        .score, .high-score {
            font-weight: bold;
            color: #333;
        }

        .controls {
            color: #666;
            font-size: 0.9em;
            margin: 10px 0;
        }

        .controls p {
            margin: 5px 0;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .button-group button {
            padding: 12px 30px;
            font-size: 1em;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .button-group button:hover {
            background-color: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1002;
        }

        .game-over.show {
            display: flex;
        }

        .game-over-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-width: 400px;
        }

        .game-over h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 1.3em;
            margin-bottom: 30px;
            color: #333;
            font-weight: bold;
        }

        .game-over button {
            padding: 12px 40px;
            font-size: 1.1em;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .game-over button:hover {
            background-color: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 640px) {
            .logo {
                font-size: 54px;
            }

            .search-container {
                max-width: 90vw;
            }

            .buttons-container {
                gap: 8px;
            }

            button {
                padding: 10px 16px;
                font-size: 13px;
            }

            .footer {
                position: static;
            }

            .footer-content {
                gap: 15px;
                flex-direction: column;
                font-size: 12px;
            }

            .snake-icon {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 26px;
            }

            .game-modal-content {
                width: 95vw;
                max-height: 95vh;
                padding: 15px;
                overflow-y: auto;
            }

            #gameCanvas {
                width: 100% !important;
                height: auto !important;
                max-width: 400px;
                aspect-ratio: 1 / 1;
                image-rendering: pixelated;
                image-rendering: crisp-edges;
            }

            .game-container {
                padding-bottom: 80px;
            }

            .game-container h1 {
                font-size: 1.8em;
            }

            .info {
                flex-direction: column;
                gap: 10px;
                font-size: 1em;
            }

            .controls {
                font-size: 0.85em;
                display: none;
            }

            .controls p {
                margin: 5px 0;
            }

            .mobile-controls {
                width: 100%;
                max-width: 280px;
                margin: 15px auto 0;
            }

            .control-btn {
                min-height: 50px;
                min-width: 50px;
                font-size: 28px;
            }

            .difficulty-selector {
                flex-direction: row;
                align-items: center;
                gap: 8px;
            }

            .difficulty-btn {
                padding: 8px 12px;
                font-size: 0.85em;
            }

            .button-group {
                flex-direction: column;
                gap: 10px;
            }

            .button-group button {
                width: 90%;
                max-width: 300px;
                padding: 12px 20px;
                font-size: 0.95em;
            }


            .mobile-controls.show {
                display: grid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="#" onclick="alert('Gmail feature not implemented in this clone'); return false;">Gmail</a>
        <a href="#" onclick="alert('Images feature not implemented in this clone'); return false;">Images</a>
        <a href="#" onclick="alert('Menu feature not implemented in this clone'); return false;">‚ãÆ</a>
    </div>

    <div class="container">
        <div class="logo">
            <span class="G">T</span><span class="o">e</span><span class="o2">d</span><span class="g2">d</span><span class="l">y</span><span class="e">s</span>
        </div>

        <div class="search-container">
            <form onsubmit="handleSearch(event)">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input 
                        type="text" 
                        class="search-input" 
                        id="searchInput" 
                        placeholder="Search Teddys or type a URL"
                        autocomplete="off"
                    >
                    <button type="button" class="clear-btn" onclick="document.getElementById('searchInput').value = ''; document.getElementById('searchInput').focus();">‚úï</button>
                </div>
            </form>
        </div>

        <div class="buttons-container">
            <button onclick="handleSearch()">Teddys Search</button>
            <button onclick="handleLuckySearch()">I'm Feeling Lucky</button>
        </div>
    </div>

    <div class="footer">
        <div class="footer-content">
            <span>Country: United States</span>
            <a href="#">About</a>
            <a href="#">Advertising</a>
            <a href="#">Business</a>
            <a href="#">How Search works</a>
            <a href="#">Privacy</a>
            <a href="#">Terms</a>
            <a href="#">Settings</a>
        </div>
    </div>

    <!-- Snake Game Icon -->
    <div class="snake-icon" onclick="openGameModal()">üêç</div>

    <!-- Game Modal -->
    <div class="game-modal" id="gameModal">
        <div class="game-modal-content">
            <button class="close-game" onclick="closeGameModal()">‚úï</button>
            
            <!-- Game Menu -->
            <div class="game-menu show" id="gameMenu">
                <h1>üêç Snake Game</h1>
                <div style="font-size: 1.2em; color: #667eea; margin: 20px 0; font-weight: bold;">
                    üèÜ High Score: <span id="highScoreDisplay">0</span>
                </div>
                <div class="menu-buttons">
                    <button class="menu-btn" onclick="startGameFromMenu()">‚ñ∂ Play</button>
                    <button class="menu-btn" onclick="showSettingsMenu()">üé® Skins</button>
                </div>
            </div>

            <!-- Difficulty Settings Menu -->
            <div class="difficulty-menu" id="difficultyMenu">
                <h2>Choose a Skin</h2>
                <div class="difficulty-options">
                    <button class="difficulty-option selected" onclick="setDifficultyAndBack('easy')">üêç Rainbow</button>
                    <button class="difficulty-option" onclick="setDifficultyAndBack('medium')">üíö Green</button>
                    <button class="difficulty-option" onclick="setDifficultyAndBack('hard')">üîµ Blue</button>
                </div>
                <button class="menu-btn back-btn" onclick="backToMainMenu()">‚Üê Back</button>
            </div>

            <div class="game-container" id="gameContainer" style="display: none;">
                <h1>üêç Snake Game</h1>
                <div class="info">
                    <div class="score">Score: <span id="score">0</span></div>
                    <div class="high-score">High Score: <span id="highScore">0</span></div>
                </div>
                <canvas id="gameCanvas" width="420" height="420"></canvas>
                <div class="controls">
                    <p>Use Arrow Keys or WASD to move</p>
                    <p>Press Space to pause/resume</p>
                </div>
                <div class="difficulty-selector">
                    <button class="difficulty-btn active" onclick="setDifficulty('easy')">Easy</button>
                    <button class="difficulty-btn" onclick="setDifficulty('medium')">Medium</button>
                    <button class="difficulty-btn" onclick="setDifficulty('hard')">Hard</button>
                </div>
                <div class="button-group">
                    <button id="startBtn">Start Game</button>
                    <button id="pauseBtn">Pause</button>
                </div>
                <div class="mobile-controls" id="mobileControls">
                    <button class="control-btn up" ontouchstart="handleMobileMove('up')">üîº</button>
                    <button class="control-btn left" ontouchstart="handleMobileMove('left')">‚óÄÔ∏è</button>
                    <button class="control-btn down" ontouchstart="handleMobileMove('down')">üîΩ</button>
                    <button class="control-btn right" ontouchstart="handleMobileMove('right')">‚ñ∂Ô∏è</button>
                </div>
            </div>

            <div class="game-over" id="gameOver">
                <div class="game-over-content">
                    <h2>Game Over!</h2>
                    <div class="final-score">Final Score: <span id="finalScore">0</span></div>
                    <button onclick="returnToMainMenu()">Play Again</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Menu Functions
        function startGameFromMenu() {
            document.getElementById('gameMenu').classList.remove('show');
            document.getElementById('gameContainer').style.display = 'block';
            initializeGame();
            startGame();
        }

        function showSettingsMenu() {
            document.getElementById('gameMenu').classList.remove('show');
            document.getElementById('difficultyMenu').classList.add('show');
        }

        function backToMainMenu() {
            document.getElementById('difficultyMenu').classList.remove('show');
            document.getElementById('gameMenu').classList.add('show');
        }

        function returnToMainMenu() {
            if (gameRunning) {
                endGame();
            }
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('gameOver').classList.remove('show');
            document.getElementById('gameMenu').classList.add('show');
        }

        function setDifficultyAndBack(level) {
            difficulty = level;
            // Update button styling
            document.querySelectorAll('.difficulty-option').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // Brief delay then back to menu
            setTimeout(() => {
                backToMainMenu();
            }, 300);
        }

        // Game Modal Functions
        function openGameModal() {
            document.getElementById('gameModal').classList.add('show');
            // Update high score display
            document.getElementById('highScoreDisplay').textContent = highScore;
            // Hide game over overlay when opening modal
            document.getElementById('gameOver').classList.remove('show');
        }

        function closeGameModal() {
            document.getElementById('gameModal').classList.remove('show');
            if (gameRunning) {
                endGame();
            }
            // Reset menu when closing
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('gameMenu').classList.add('show');
            document.getElementById('difficultyMenu').classList.remove('show');
            document.getElementById('gameOver').classList.remove('show');
        }

        // Close modal when clicking outside content
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('gameModal');
            if (e.target === modal) {
                closeGameModal();
            }
        });

        let canvas, ctx;
        let gameVariablesInitialized = false;

        // Game variables
        const gridSize = 30;
        let tileCount;
        let snake = [{ x: 10, y: 10 }];
        let food = { x: 15, y: 15 };
        let direction = { x: 1, y: 0 };
        let nextDirection = { x: 1, y: 0 };
        let score = 0;
        let gameRunning = false;
        let gamePaused = false;
        let gameLoopId = null;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let difficulty = 'easy';
        let gameFrameCount = 0;
        let smileFrames = 0;
        
        // Difficulty speeds (in milliseconds)
        const difficultySettings = {
            easy: 150,
            medium: 100,
            hard: 60
        };

        function initializeGame() {
            if (!gameVariablesInitialized) {
                canvas = document.getElementById('gameCanvas');
                ctx = canvas.getContext('2d');
                
                // Make canvas responsive on mobile
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                
                if (isMobile) {
                    // For mobile, scale down the game board slightly to fit better
                    const maxCanvasSize = Math.min(window.innerWidth - 40, 340);
                    canvas.width = maxCanvasSize;
                    canvas.height = maxCanvasSize;
                } else {
                    canvas.width = 420;
                    canvas.height = 420;
                }
                
                tileCount = canvas.width / gridSize;
                gameVariablesInitialized = true;
            }
            document.getElementById('highScore').textContent = highScore;
            
            // Show mobile controls on mobile devices
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const mobileControls = document.getElementById('mobileControls');
            if (isMobile && mobileControls) {
                mobileControls.classList.add('show');
            }
            
            draw();
        }

        function setDifficulty(level) {
            difficulty = level;
            // Update button styling
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Restart game with new difficulty
            if (gameRunning) {
                clearInterval(gameLoopId);
                gameLoopId = setInterval(gameLoop, difficultySettings[difficulty]);
            }
        }

        // Generate random food position
        function generateFood() {
            let newFood;
            let validPosition = false;
            while (!validPosition) {
                newFood = {
                    x: Math.floor(Math.random() * tileCount),
                    y: Math.floor(Math.random() * tileCount)
                };
                validPosition = !snake.some(segment => segment.x === newFood.x && segment.y === newFood.y);
            }
            return newFood;
        }

        // Draw game
        function draw() {
            if (!canvas) return;
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw grid (optional - light grid)
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= tileCount; i++) {
                ctx.beginPath();
                ctx.moveTo(i * gridSize, 0);
                ctx.lineTo(i * gridSize, canvas.height);
                ctx.stroke();

                ctx.beginPath();
                ctx.moveTo(0, i * gridSize);
                ctx.lineTo(canvas.width, i * gridSize);
                ctx.stroke();
            }

            // Draw snake with smooth rainbow gradient
            function hslToRgb(h, s, l) {
                const a = s * Math.min(l, 1 - l);
                const f = n => {
                    const k = (n + h / 30) % 12;
                    return l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                };
                return `rgb(${Math.round(f(0) * 255)}, ${Math.round(f(8) * 255)}, ${Math.round(f(4) * 255)})`;
            }
            
            snake.forEach((segment, index) => {
                // Calculate rainbow hue based on position in snake (0-360)
                const hue = (index / snake.length * 360) % 360;
                
                if (index === 0) {
                    // Head - bright color with rounded corners
                    ctx.fillStyle = hslToRgb(hue, 1, 0.5);
                    ctx.shadowColor = hslToRgb(hue, 1, 0.3);
                    ctx.shadowBlur = 15;
                    const headX = segment.x * gridSize + 1;
                    const headY = segment.y * gridSize + 1;
                    const headW = gridSize - 2;
                    const headH = gridSize - 2;
                    const radius = 6;
                    
                    // Draw rounded rectangle for head
                    ctx.beginPath();
                    ctx.moveTo(headX + radius, headY);
                    ctx.lineTo(headX + headW - radius, headY);
                    ctx.quadraticCurveTo(headX + headW, headY, headX + headW, headY + radius);
                    ctx.lineTo(headX + headW, headY + headH - radius);
                    ctx.quadraticCurveTo(headX + headW, headY + headH, headX + headW - radius, headY + headH);
                    ctx.lineTo(headX + radius, headY + headH);
                    ctx.quadraticCurveTo(headX, headY + headH, headX, headY + headH - radius);
                    ctx.lineTo(headX, headY + radius);
                    ctx.quadraticCurveTo(headX, headY, headX + radius, headY);
                    ctx.closePath();
                    ctx.fill();
                    
                    // Add highlight to head
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                    ctx.beginPath();
                    ctx.arc(headX + 6, headY + 6, 4, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw border
                    ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
                    ctx.lineWidth = 1.5;
                    ctx.beginPath();
                    ctx.moveTo(headX + radius, headY);
                    ctx.lineTo(headX + headW - radius, headY);
                    ctx.quadraticCurveTo(headX + headW, headY, headX + headW, headY + radius);
                    ctx.lineTo(headX + headW, headY + headH - radius);
                    ctx.quadraticCurveTo(headX + headW, headY + headH, headX + headW - radius, headY + headH);
                    ctx.lineTo(headX + radius, headY + headH);
                    ctx.quadraticCurveTo(headX, headY + headH, headX, headY + headH - radius);
                    ctx.lineTo(headX, headY + radius);
                    ctx.quadraticCurveTo(headX, headY, headX + radius, headY);
                    ctx.closePath();
                    ctx.stroke();
                    
                    // Draw detailed eyes on head - eyes extend outside tile
                    const headCenterX = segment.x * gridSize + gridSize / 2;
                    const headCenterY = segment.y * gridSize + gridSize / 2;
                    const eyeRadius = 6;
                    const pupilRadius = 3;
                    
                    // Add bobble effect to eyes based on frame count
                    const bobbleAmount = Math.sin(gameFrameCount * 0.1) * 2;
                    
                    // Draw white eye backgrounds - larger eyes that extend outside
                    ctx.fillStyle = '#FFFFFF';
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                    ctx.shadowBlur = 8;
                    
                    let eye1X, eye1Y, eye2X, eye2Y;
                    
                    // Position eyes based on direction - extend beyond tile with bobble
                    if (direction.x === 1) { // Moving right
                        eye1X = headCenterX + 18;
                        eye1Y = headCenterY - 8 + bobbleAmount;
                        eye2X = headCenterX + 18;
                        eye2Y = headCenterY + 8 - bobbleAmount;
                    } else if (direction.x === -1) { // Moving left
                        eye1X = headCenterX - 18;
                        eye1Y = headCenterY - 8 + bobbleAmount;
                        eye2X = headCenterX - 18;
                        eye2Y = headCenterY + 8 - bobbleAmount;
                    } else if (direction.y === -1) { // Moving up
                        eye1X = headCenterX - 8 + bobbleAmount;
                        eye1Y = headCenterY - 18;
                        eye2X = headCenterX + 8 - bobbleAmount;
                        eye2Y = headCenterY - 18;
                    } else if (direction.y === 1) { // Moving down
                        eye1X = headCenterX - 8 + bobbleAmount;
                        eye1Y = headCenterY + 18;
                        eye2X = headCenterX + 8 - bobbleAmount;
                        eye2Y = headCenterY + 18;
                    }
                    
                    // Draw eyes
                    ctx.beginPath();
                    ctx.arc(eye1X, eye1Y, eyeRadius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.beginPath();
                    ctx.arc(eye2X, eye2Y, eyeRadius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw pupils
                    ctx.fillStyle = '#000000';
                    ctx.shadowColor = 'transparent';
                    
                    // If eating an apple, draw happy closed eyes instead
                    if (smileFrames > 0) {
                        ctx.beginPath();
                        ctx.arc(eye1X, eye1Y, 3, 0, Math.PI * 2);
                        ctx.fill();
                        
                        ctx.beginPath();
                        ctx.arc(eye2X, eye2Y, 3, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                        // Normal pupils
                        ctx.beginPath();
                        ctx.arc(eye1X, eye1Y, pupilRadius, 0, Math.PI * 2);
                        ctx.fill();
                        
                        ctx.beginPath();
                        ctx.arc(eye2X, eye2Y, pupilRadius, 0, Math.PI * 2);
                        ctx.fill();
                        
                        // Draw eye shine/glint (only when not eating)
                        ctx.fillStyle = '#FFFFFF';
                        ctx.beginPath();
                        ctx.arc(eye1X - 1.5, eye1Y - 1.5, 1.5, 0, Math.PI * 2);
                        ctx.fill();
                        
                        ctx.beginPath();
                        ctx.arc(eye2X - 1.5, eye2Y - 1.5, 1.5, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    // Draw mouth/smile
                    ctx.strokeStyle = '#FF1744';
                    ctx.lineWidth = 3;
                    ctx.lineCap = 'round';
                    
                    // Make smile bigger and more expressive when eating
                    const smileScale = smileFrames > 0 ? 1.5 : 1;
                    const smileRadius = 5 * smileScale;
                    
                    if (direction.x === 1) { // Moving right
                        ctx.beginPath();
                        ctx.arc(headCenterX + 8, headCenterY, smileRadius, -Math.PI / 2, Math.PI / 2);
                        ctx.stroke();
                    } else if (direction.x === -1) { // Moving left
                        ctx.beginPath();
                        ctx.arc(headCenterX - 8, headCenterY, smileRadius, Math.PI / 2, -Math.PI / 2);
                        ctx.stroke();
                    } else if (direction.y === -1) { // Moving up
                        ctx.beginPath();
                        ctx.arc(headCenterX, headCenterY - 8, smileRadius, 0, Math.PI);
                        ctx.stroke();
                    } else if (direction.y === 1) { // Moving down
                        ctx.beginPath();
                        ctx.arc(headCenterX, headCenterY + 8, smileRadius, Math.PI, 0);
                        ctx.stroke();
                    }
                } else {
                    // Body - smooth rainbow gradient with rounded corners
                    ctx.fillStyle = hslToRgb(hue, 1, 0.5);
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
                    ctx.shadowBlur = 5;
                    
                    const bodyX = segment.x * gridSize + 1;
                    const bodyY = segment.y * gridSize + 1;
                    const bodyW = gridSize - 2;
                    const bodyH = gridSize - 2;
                    const bodyRadius = 4;
                    
                    // Draw rounded rectangle for body
                    ctx.beginPath();
                    ctx.moveTo(bodyX + bodyRadius, bodyY);
                    ctx.lineTo(bodyX + bodyW - bodyRadius, bodyY);
                    ctx.quadraticCurveTo(bodyX + bodyW, bodyY, bodyX + bodyW, bodyY + bodyRadius);
                    ctx.lineTo(bodyX + bodyW, bodyY + bodyH - bodyRadius);
                    ctx.quadraticCurveTo(bodyX + bodyW, bodyY + bodyH, bodyX + bodyW - bodyRadius, bodyY + bodyH);
                    ctx.lineTo(bodyX + bodyRadius, bodyY + bodyH);
                    ctx.quadraticCurveTo(bodyX, bodyY + bodyH, bodyX, bodyY + bodyH - bodyRadius);
                    ctx.lineTo(bodyX, bodyY + bodyRadius);
                    ctx.quadraticCurveTo(bodyX, bodyY, bodyX + bodyRadius, bodyY);
                    ctx.closePath();
                    ctx.fill();
                    
                    // Add subtle highlight to body
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
                    ctx.beginPath();
                    ctx.arc(bodyX + 4, bodyY + 4, 3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw border
                    ctx.strokeStyle = 'rgba(0, 0, 0, 0.15)';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(bodyX + bodyRadius, bodyY);
                    ctx.lineTo(bodyX + bodyW - bodyRadius, bodyY);
                    ctx.quadraticCurveTo(bodyX + bodyW, bodyY, bodyX + bodyW, bodyY + bodyRadius);
                    ctx.lineTo(bodyX + bodyW, bodyY + bodyH - bodyRadius);
                    ctx.quadraticCurveTo(bodyX + bodyW, bodyY + bodyH, bodyX + bodyW - bodyRadius, bodyY + bodyH);
                    ctx.lineTo(bodyX + bodyRadius, bodyY + bodyH);
                    ctx.quadraticCurveTo(bodyX, bodyY + bodyH, bodyX, bodyY + bodyH - bodyRadius);
                    ctx.lineTo(bodyX, bodyY + bodyRadius);
                    ctx.quadraticCurveTo(bodyX, bodyY, bodyX + bodyRadius, bodyY);
                    ctx.closePath();
                    ctx.stroke();
                }
            });

            // Draw food as apple - disable all shadow effects
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
            ctx.globalAlpha = 1;
            ctx.filter = 'none';
            ctx.font = `${gridSize - 4}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#000000';
            ctx.fillText('üçé', 
                food.x * gridSize + gridSize / 2,
                food.y * gridSize + gridSize / 2
            );
        }

        // Update game state
        function update() {
            direction = nextDirection;

            // Calculate new head position
            const head = snake[0];
            const newHead = {
                x: head.x + direction.x,
                y: head.y + direction.y
            };

            // Check collision with walls
            if (newHead.x < 0 || newHead.x >= tileCount || newHead.y < 0 || newHead.y >= tileCount) {
                endGame();
                return;
            }

            // Check collision with self
            if (snake.some(segment => segment.x === newHead.x && segment.y === newHead.y)) {
                endGame();
                return;
            }

            // Add new head
            snake.unshift(newHead);

            // Check if food is eaten
            if (newHead.x === food.x && newHead.y === food.y) {
                score += 10;
                document.getElementById('score').textContent = score;
                smileFrames = 10; // Show smile for 10 frames
                food = generateFood();
            } else {
                // Remove tail if no food eaten
                snake.pop();
            }
        }

        // Game loop
        function gameLoop() {
            if (!gamePaused) {
                update();
                gameFrameCount++;
            }
            draw();
            
            // Decrement smile frames
            if (smileFrames > 0) {
                smileFrames--;
            }
        }

        // Start game
        function startGame() {
            if (!gameRunning) {
                gameRunning = true;
                gamePaused = false;
                snake = [{ x: 10, y: 10 }];
                direction = { x: 1, y: 0 };
                nextDirection = { x: 1, y: 0 };
                score = 0;
                gameFrameCount = 0;
                food = generateFood();
                document.getElementById('score').textContent = score;
                document.getElementById('gameOver').classList.remove('show');
                document.getElementById('startBtn').textContent = 'Restart';
                
                if (!gameLoopId) {
                    gameLoopId = setInterval(gameLoop, difficultySettings[difficulty]);
                }
            }
        }

        // Pause game
        function togglePause() {
            if (gameRunning) {
                gamePaused = !gamePaused;
                document.getElementById('pauseBtn').textContent = gamePaused ? 'Resume' : 'Pause';
            }
        }

        // End game
        function endGame() {
            gameRunning = false;
            clearInterval(gameLoopId);
            gameLoopId = null;

            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHighScore', highScore);
                document.getElementById('highScore').textContent = highScore;
            }

            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOver').classList.add('show');
            document.getElementById('pauseBtn').textContent = 'Pause';
        }

        // Handle keyboard input
        document.addEventListener('keydown', (e) => {
            if (!gameRunning && !gamePaused) return;

            const key = e.key.toLowerCase();

            switch (key) {
                case 'arrowup':
                case 'w':
                    e.preventDefault();
                    if (direction.y === 0) nextDirection = { x: 0, y: -1 };
                    break;
                case 'arrowdown':
                case 's':
                    e.preventDefault();
                    if (direction.y === 0) nextDirection = { x: 0, y: 1 };
                    break;
                case 'arrowleft':
                case 'a':
                    e.preventDefault();
                    if (direction.x === 0) nextDirection = { x: -1, y: 0 };
                    break;
                case 'arrowright':
                case 'd':
                    e.preventDefault();
                    if (direction.x === 0) nextDirection = { x: 1, y: 0 };
                    break;
                case ' ':
                    e.preventDefault();
                    togglePause();
                    break;
            }
        });

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            
            if (startBtn) startBtn.addEventListener('click', startGame);
            if (pauseBtn) pauseBtn.addEventListener('click', togglePause);
        });

        // Fallback for event listeners if DOM is already loaded
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        
        if (startBtn) startBtn.addEventListener('click', startGame);
        if (pauseBtn) pauseBtn.addEventListener('click', togglePause);

        // Search functionality
        function handleSearch(event) {
            if (event) {
                event.preventDefault();
            }
            const searchInput = document.getElementById('searchInput');
            const query = searchInput.value.trim();
            
            if (!query) {
                return;
            }
            
            // Check if input is a URL
            if (isValidURL(query)) {
                window.location.href = query;
            } else {
                // Perform a Google search
                window.location.href = 'https://www.google.com/search?q=' + encodeURIComponent(query);
            }
        }

        function handleLuckySearch() {
            const searchInput = document.getElementById('searchInput');
            const query = searchInput.value.trim();
            
            if (!query) {
                return;
            }
            
            // Check if input is a URL
            if (isValidURL(query)) {
                window.location.href = query;
            } else {
                // Perform a Google Lucky Search
                window.location.href = 'https://www.google.com/search?q=' + encodeURIComponent(query) + '&btnI=true';
            }
        }

        function isValidURL(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        // Mobile touch controls
        function handleMobileMove(direction) {
            if (!gameRunning || gamePaused) return;
            
            switch (direction) {
                case 'up':
                    if (direction_y === 0) nextDirection = { x: 0, y: -1 };
                    break;
                case 'down':
                    if (direction_y === 0) nextDirection = { x: 0, y: 1 };
                    break;
                case 'left':
                    if (direction_x === 0) nextDirection = { x: -1, y: 0 };
                    break;
                case 'right':
                    if (direction_x === 0) nextDirection = { x: 1, y: 0 };
                    break;
            }
        }

        // Fix variable names in handleMobileMove
        Object.defineProperty(window, 'direction_x', {
            get: function() { return direction.x; }
        });
        Object.defineProperty(window, 'direction_y', {
            get: function() { return direction.y; }
        });
    </script>
</body>
</html>